generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Author {
  author_id   Int     @id @default(autoincrement())
  name_author String
  biography   String  @db.Text
  photo       String?
  books       Book[]

  @@map("authors")
}

model Book {
  book_id     Int     @id @default(autoincrement())
  title       String
  description String? @db.Text
  author_id   Int
  photo       String?

  author  Author   @relation(fields: [author_id], references: [author_id])
  loans   Loan[]
  reviews Review[]

  @@map("books")
}

model User {
  id               Int     @id @default(autoincrement())
  username         String  @unique
  password         String
  role             String  @default("user")
  favorite_book_id Int?
  profile_image    String?
  description      String? @db.Text

  loans   Loan[]
  reviews Review[]

  @@map("users")
}

model Loan {
  loans_id  Int      @id @default(autoincrement())
  user_id   Int
  book_id   Int
  loan_date DateTime @default(now())

  user User @relation(fields: [user_id], references: [id])
  book Book @relation(fields: [book_id], references: [book_id])

  @@map("loans")
}

model Review {
  review_id   Int      @id @default(autoincrement())
  book_id     Int
  user_id     Int
  rating      Int
  comment     String?  @db.Text
  review_date DateTime @default(now())

  user User @relation(fields: [user_id], references: [id])
  book Book @relation(fields: [book_id], references: [book_id])

  @@map("reviews")
}
